# 竞猜项目文档

http://web.yy.com/quiz/index.html

## 项目目录

* 开发目录：https://svn.yy.com/yy-music/static/project/quiz/branches/develop
* 测试环境：https://svn.yy.com/yy-music/static/project/quiz/branches/commit
* 线上环境：https://svn.yy.com/yy-music/static/project/quiz/trunk

## 接口文档

[http://doc.ys.m.yy.com:8090/pages/viewpage.action?pageId=3065378](http://doc.ys.m.yy.com:8090/pages/viewpage.action?pageId=3065378)

## 需求文档

https://svn.yy.com/repos/Project/07_手机yy/03_产品文档/YYLive_7.4/游戏模板竞猜玩法/【蔡泽煌】游戏模板竞猜玩法需求_V16-简易竞猜.docx

## 开发流程

* 运行`npm run dev`进行开发调试；
* 运行`npm run build`进行测试环境打包到`dist`目录；
* 运行`npm run prod`进行线上环境打包到**tasks/webpack.product.js**文件中`outputPath`配置的路径目录。

## 功能模块

* index.js：入口文件
* js/data.js：数据监听（通过刷新数据修改DOM结构）
* js/handler.js：数据请求
* js/quiz.js：竞猜面板主逻辑
* js/betting.js：投注弹窗逻辑
* js/recommend.js：推荐主播逻辑
* js/toast.js：toast弹窗
* js/util.js：工具库

## 广播

定义全局方法，后端需要广播时通过客户端调用全局方法实现，和活动条逻辑相同。

### onReceivePush

监听竞猜广播，监听前需要注册广播

```
window.yyApiUtil.invokeYyApi('data', 'registerPush', {
    biz: 'quiz'
});
```

### refreshDiamond

监听碎钻广播

